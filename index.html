<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AniFind -  Discover anime title!</title>

  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Acme&family=Noto+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

  <script src="https://kit.fontawesome.com/500fe0f482.js" crossorigin="anonymous"></script>
</head>
<body>
  <header class="bg_1">
    <div class="head_menu"><i class="fa-solid fa-bars icon" onclick="closeMenu()"></i></div>
    <div class="head_logo c_1">
      AniFind
    </div>
    <!-- <div class="head_mid c_2">
      Get anime information here!
    </div> -->
    <div class="head_right">
      <a href="https://myanimelist.net/" target="_blank"><img src="assets/MyAnimeList_Logo.png" alt="MAL Logo"></a>
      <a href="https://www.anitrendz.com/" target="_blank"><img src="assets/Anitrenz_logo.png" alt="AniTrenz Logo"></a>
    </div>
  </header>

  <div class="menu_wrapper hidden">
    <div class="menu bg_1">
      <div class="menu_top">
        <i class="fa-solid fa-xmark icon" onclick="closeMenu()"></i>
        <div class="c_1">AniFind</div>
      </div>
      <div class="menu_mid">
        <ul class="menu_list">
          <li>
            <div class="link" onclick="closeList(this)">Search Anime</div>
            <ul class="hidden">
              <li><a href="search.html" class="link"><img src="assets/MyAnimeList_Logo.png" alt="MAL Logo">Search</a></li>
              <li><a href="#this_session_card" class="link"><img src="assets/MyAnimeList_Logo.png" alt="MAL Logo">This season</a></li>
              <li><a href="#next_season_card" class="link"><img src="assets/MyAnimeList_Logo.png" alt="MAL Logo">Next season</a></li>
            </ul>
          </li>
          <li>
            <div class="link" onclick="closeList(this)">Top Anime</div>
            <ul class="hidden">
              <li><a href="#top_rated_card" class="link"><img src="assets/MyAnimeList_Logo.png" alt="MAL Logo">Top rated</a></li>
              <li><a href="#top_last_week_card" class="link"><img src="assets/Anitrenz_logo.png" alt="AniTrenz Logo">Top last week</a></li>
            </ul>
          </li>
          <li>
            <div class="link" onclick="closeList(this)">Top Character</div>
            <ul class="hidden">
              <li><a href="#top_chara_card" class="link"><img src="assets/MyAnimeList_Logo.png" alt="MAL Logo">Most favorited</a></li>
              <li><a href="#top_male_card" class="link"><img src="assets/Anitrenz_logo.png" alt="AniTrenz Logo">Top male character</a></li>
              <li><a href="#top_female_card" class="link"><img src="assets/Anitrenz_logo.png" alt="AniTrenz Logo">Top female character</a></li>
            </ul>
          </li>
        </ul>
      </div>
      <div class="menu_bot">
        <span class="c_2">Switch theme</span> <i class="fa-solid fa-circle-half-stroke icon"></i>
      </div>
    </div>
  </div>

  <main>
    <section class="search padding bg_1">
      <div class="search_top">
        <form action="/search.html">
          <input type="text" name="keyword" placeholder="Search anime title ..." class="bg_3 c_2">
          <button>Search</button>
        </form>
      </div>
      <div class="search_bot">
        <p class="c_1">Explore Anime Titles: <br> Your Gateway to Excitement!</p>
        <a href="#" class="card c_2 bg_3" id="this_session_card">
          <div class="bg_2 mal"><img src="assets/MyAnimeList_Logo.png" alt="MAL Logo">This Season</div>
          <ul id="this_season">
            
          </ul>
        </a>
        <a href="#" class="card c_2 bg_3" id="next_season_card">
          <div class="bg_2 mal"><img src="assets/MyAnimeList_Logo.png" alt="MAL Logo">Next Season</div>
          <ul id="next_season">
            
          </ul>
        </a>
      </div>
    </section>

    <section class="anime padding bg_2">
      <div class="anime_top c_1">
        <p>Top Anime</p>
      </div>
      <div class="anime_bot">
        <a href="#" class="card c_2 bg_3" id="top_rated_card">
          <div class="bg_2 mal"><img src="assets/MyAnimeList_Logo.png" alt="MAL Logo">Top Rated</div>
          <ul id="top_rated">
            
          </ul>
        </a>
        <a href="#" class="card c_2 bg_3" id="top_last_week_card">
          <div class="bg_2 anitrendz c_1"><img src="assets/Anitrenz_logo.png" alt="AniTrenz Logo">Top Last Week</div>
          <ul id="top_last_week">
            
          </ul>
        </a>
      </div>
    </section>

    <section class="chara padding bg_1">
      <div class="chara_top c_1">
        <p>Top Character</p>
      </div>
      <div class="chara_bot">
        <a href="#" class="card c_2 bg_3" id="top_chara_card">
          <div class="bg_2 mal"><img src="assets/MyAnimeList_Logo.png" alt="MAL Logo">Most Favorited</div>
          <ul id="top_chara">
            
          </ul>
        </a>
        <a href="#" class="card c_2 bg_3" id="top_male_card">
          <div class="bg_2 anitrendz c_1"><img src="assets/Anitrenz_logo.png" alt="AniTrenz Logo">Top Male Character</div>
          <ul id="top_male">
            
          </ul>
        </a>
        <a href="#" class="card c_2 bg_3" id="top_female_card">
          <div class="bg_2 anitrendz c_1"><img src="assets/Anitrenz_logo.png" alt="AniTrenz Logo">Top Female Character</div>
          <ul id="top_female">
            
          </ul>
        </a>
      </div>
    </section>
  </main>

  <script>
    function closeMenu() {
      const menu = document.querySelector('.menu_wrapper');
      menu.classList.toggle('hidden');
    }

    function closeList(el) {
      el.nextElementSibling.classList.toggle('hidden');
    }

    let dateNow = new Date(), monthNow = dateNow.getMonth(), yearNow = dateNow.getFullYear(), 
    season = 'fall', seasonNext = 'winter', yearNext = yearNow + 1;
    // winter, spring, summer, fall
    if (monthNow < 3) {
      season = 'winter';
      seasonNext = 'spring';
      yearNext = yearNow;
    } else if (monthNow < 6) {
      season = 'spring';
      seasonNext = 'summer';
      yearNext = yearNow;
    } else if (monthNow < 9) {
      season = 'summer';
      seasonNext = 'fall';
      yearNext = yearNow;
    }

    const thisSeason = document.querySelector('#this_season');
    // fetch(`https://api.jikan.moe/v4/seasons/${yearNow}/${season}?limit=20`)
    fetch(`this_season.json`)
      .then(response => response.json())
        .then(response => {
          let i = 0;
          const topThisSeason = response.data;
          const thisSeasonEl = topThisSeason.reduce((result, anime, index) => {
            if (anime.season && i < 10) {
              i++;
              return `${result} 
              <li>
                <img src="${anime.images.webp.large_image_url}">
                <span>${anime.title}</span>
              </li>`;
            } else {
              return `${result}`;
            }
          }, '');
          thisSeason.innerHTML = thisSeasonEl;
        });

    const nextSeason = document.querySelector('#next_season');
    // fetch(`https://api.jikan.moe/v4/seasons/${yearNext}/${seasonNext}?limit=20`)
    fetch('next_season.json')
      .then(response => response.json())
        .then(response => {
          let i = 0;
          const topnextSeason = response.data;
          const nextSeasonEl = topnextSeason.reduce((result, anime, index) => {
            if (anime.season && i < 10) {
              i++;
              return `${result} 
              <li>
                <img src="${anime.images.webp.large_image_url}">
                <span>${anime.title}</span>
              </li>`;
            } else {
              return `${result}`;
            }
          }, '');
          nextSeason.innerHTML = nextSeasonEl;
        });
    
    const topRated = document.querySelector('#top_rated');
    // fetch('https://api.jikan.moe/v4/top/anime?limit=10')
    fetch('top_rated.json')
      .then(response => response.json())
      .then(response => {
        const topAnimeList = response.data;
        const topAnimeEl = topAnimeList.reduce((result, anime, index) => {
          return `${result} 
          <li>
            <div class="anime_number">${index + 1}</div>
            <div class="anime_img">
              <img src="${anime.images.webp.large_image_url}"><span>${anime.title} <br> â˜… ${anime.score}</span>
            </div>
          </li>`
        }, '');
        topRated.innerHTML = topAnimeEl;
      });

    const topChara = document.querySelector('#top_chara');
    // fetch('https://api.jikan.moe/v4/top/characters?limit=10')
    fetch('top_chara.json')
      .then(response => response.json())
      .then(response => {
        const topCharaList = response.data;
        const topCharaEl = topCharaList.reduce((result, chara, index) => {
          return `${result} 
          <li class="bg_2">
            <div class="anime_number">${index + 1}</div>
            <div>
              ${chara.name}<img src="${chara.images.webp.image_url}">
            </div>
          </li>`
        }, '');
        topChara.innerHTML = topCharaEl;
      })

    const topLastWeek = document.querySelector('#top_last_week');
    // fetch('http://cors-anywhere.herokuapp.com/https://www.anitrendz.com/_next/data/SXBntXpTEo1NZDHhs8HR-/charts/top-anime.json?slug=top-anime')
    // fetch('https://www.anitrendz.com/_next/data/SXBntXpTEo1NZDHhs8HR-/charts/top-anime.json?slug=top-anime')
    fetch('top_week.json')
      .then(response => response.json())
        .then(response => {
          let i = 0;
          const topLastAnimeList = response.pageProps.charts[0].choices;
          const topLastAnimeEl = topLastAnimeList.reduce((result, anime, index) => {
            if (i < 10) {
              i++;
              return `${result} 
              <li>
                <div class="anime_number">${index + 1}</div>
                <div class="anime_img">
                  <img src="${anime.images.large}"><span>${anime.namealt ? anime.namealt : anime.name}</span>
                </div>
              </li>`;
            } else {
              return `${result}`;
            }
          }, '');
          topLastWeek.innerHTML = topLastAnimeEl;
        });
    
    const topMale = document.querySelector('#top_male');
    // fetch('http://cors-anywhere.herokuapp.com/https://www.anitrendz.com/_next/data/SXBntXpTEo1NZDHhs8HR-/charts/male-characters.json?slug=male-characters')
    // fetch('https://www.anitrendz.com/_next/data/SXBntXpTEo1NZDHhs8HR-/charts/male-characters.json?slug=male-characters')
    fetch('top_male.json')
      .then(response => response.json())
        .then(response => {
          let i = 0;
          const topMaleList = response.pageProps.charts[0].choices;
          const topMaleEl = topMaleList.reduce((result, chara, index) => {
            if (i < 10) {
              i++;
              return `${result} 
              <li class="bg_2">
              <div class="anime_number">${index + 1}</div>
              <div>
                ${chara.name}<img src="${chara.images.medium}">
              </div>
            </li>`;
            } else {
              return `${result}`;
            }
          }, '');
          topMale.innerHTML = topMaleEl;
        });

    const topFemale = document.querySelector('#top_female');
    // fetch('https://corsproxy.io/?' + encodee)
    // fetch('http://cors-anywhere.herokuapp.com/https://www.anitrendz.com/_next/data/SXBntXpTEo1NZDHhs8HR-/charts/female-characters.json?slug=female-characters')
    // fetch('https://www.anitrendz.com/_next/data/SXBntXpTEo1NZDHhs8HR-/charts/female-characters.json?slug=female-characters')
    fetch('top_female.json')
      .then(response => response.json())
        .then(response => {
          let i = 0;
          const topFemaleList = response.pageProps.charts[0].choices;
          const topFemaleEl = topFemaleList.reduce((result, chara, index) => {
            if (i < 10) {
              i++;
              return `${result} 
              <li class="bg_2">
              <div class="anime_number">${index + 1}</div>
              <div>
                ${chara.name}<img src="${chara.images ? chara.images.medium : ''}">
              </div>
            </li>`;
            } else {
              return `${result}`;
            }
          }, '');
          topFemale.innerHTML = topFemaleEl;
        });
    // https://www.anitrendz.com/_next/data/SXBntXpTEo1NZDHhs8HR-/charts/top-anime.json?slug=top-anime
    // https://www.anitrendz.com/_next/data/SXBntXpTEo1NZDHhs8HR-/charts/male-characters.json?slug=male-characters
    // https://www.anitrendz.com/_next/data/SXBntXpTEo1NZDHhs8HR-/charts/female-characters.json?slug=female-characters
    // https://www.anitrendz.com/_next/data/SXBntXpTEo1NZDHhs8HR-/charts/top-anime/2014-12-20.json?slug=top-anime&date=2014-12-20
    // https://www.anitrendz.com/_next/data/SXBntXpTEo1NZDHhs8HR-/charts/male-characters/2023-12-19.json?slug=male-characters&date=2023-12-19
    // https://www.anitrendz.com/_next/data/SXBntXpTEo1NZDHhs8HR-/charts/male-characters/2023-12-12.json?slug=male-characters&date=2023-12-12
    
  </script>
</body>
</html>